# GitHub Actions å·¥ä½œæµè¯´æ˜

## Docker è‡ªåŠ¨æ„å»ºå’Œæ¨é€

æœ¬é¡¹ç›®é…ç½®äº†è‡ªåŠ¨æ„å»ºDockeré•œåƒå¹¶æ¨é€åˆ°Docker Hubçš„GitHub Actionså·¥ä½œæµã€‚

### ğŸš€ è§¦å‘æ–¹å¼

#### 1. è‡ªåŠ¨è§¦å‘ï¼ˆLatestæ ‡ç­¾ï¼‰
- **è§¦å‘æ¡ä»¶**ï¼šæ¨é€ä»£ç åˆ° `main` åˆ†æ”¯
- **ç”Ÿæˆæ ‡ç­¾**ï¼š
  - `latest` - æœ€æ–°ç¨³å®šç‰ˆæœ¬
  - `YYYYMMDD-<git-hash>` - å¸¦æ—¥æœŸå’Œæäº¤å“ˆå¸Œçš„ç‰ˆæœ¬

```bash
git add .
git commit -m "æ›´æ–°åŠŸèƒ½"
git push origin main
```

#### 2. æ‰‹åŠ¨è§¦å‘ï¼ˆBeta/Latestæ ‡ç­¾ï¼‰
- **è§¦å‘ä½ç½®**ï¼šGitHubä»“åº“ â†’ Actions â†’ Docker Build and Push â†’ Run workflow
- **å¯é€‰ç±»å‹**ï¼š
  - `beta` - å‘å¸ƒBetaæµ‹è¯•ç‰ˆæœ¬ï¼ˆbeta-1, beta-2, beta-3...è‡ªåŠ¨é€’å¢ï¼‰
  - `latest` - æ‰‹åŠ¨å‘å¸ƒLatestç‰ˆæœ¬

**Betaç‰ˆæœ¬ç‰¹æ€§ï¼š**
- è‡ªåŠ¨æ£€æµ‹æœ€æ–°çš„betaæ ‡ç­¾
- ç‰ˆæœ¬å·è‡ªåŠ¨é€’å¢ï¼ˆbeta-1 â†’ beta-2 â†’ beta-3...ï¼‰
- åŒæ—¶æ¨é€ä¸¤ä¸ªæ ‡ç­¾ï¼š`beta-N` å’Œ `beta`

### ğŸ“¦ ç”Ÿæˆçš„Dockeré•œåƒæ ‡ç­¾

| è§¦å‘æ–¹å¼ | æ ‡ç­¾ | è¯´æ˜ |
|---------|------|------|
| Pushåˆ°main | `latest` | æœ€æ–°ç¨³å®šç‰ˆ |
| Pushåˆ°main | `20251218-abc1234` | æ—¥æœŸ+çŸ­å“ˆå¸Œç‰ˆæœ¬ |
| æ‰‹åŠ¨Beta | `beta-1`, `beta-2`... | é€’å¢çš„Betaç‰ˆæœ¬å· |
| æ‰‹åŠ¨Beta | `beta` | å§‹ç»ˆæŒ‡å‘æœ€æ–°çš„Betaç‰ˆæœ¬ |
| æ‰‹åŠ¨Latest | `latest` | æ‰‹åŠ¨å‘å¸ƒçš„ç¨³å®šç‰ˆ |

### ğŸ”§ é…ç½®è¦æ±‚

åœ¨GitHubä»“åº“è®¾ç½®ä¸­æ·»åŠ ä»¥ä¸‹Secretsï¼ˆSettings â†’ Secrets and variables â†’ Actionsï¼‰ï¼š

| Secretåç§° | è¯´æ˜ | ç¤ºä¾‹ |
|-----------|------|------|
| `DOCKERHUB_USERNAME` | Docker Hubç”¨æˆ·å | `lansepyy` |
| `DOCKERHUB_TOKEN` | Docker Hubè®¿é—®ä»¤ç‰Œ | åœ¨Docker Hubç”Ÿæˆ |

### ğŸ” ç”ŸæˆDocker Hubè®¿é—®ä»¤ç‰Œ

1. ç™»å½• [Docker Hub](https://hub.docker.com/)
2. ç‚¹å‡»å³ä¸Šè§’å¤´åƒ â†’ Account Settings
3. å·¦ä¾§èœå•é€‰æ‹© Security â†’ New Access Token
4. è¾“å…¥ä»¤ç‰Œæè¿°ï¼ˆå¦‚ï¼šGitHub Actionsï¼‰
5. é€‰æ‹©æƒé™ï¼šRead, Write, Delete
6. å¤åˆ¶ç”Ÿæˆçš„ä»¤ç‰Œï¼ˆåªæ˜¾ç¤ºä¸€æ¬¡ï¼‰

### ğŸ“‹ ä½¿ç”¨ç¤ºä¾‹

#### æ‹‰å–Latestç‰ˆæœ¬
```bash
docker pull lansepyy/tg-telegram-imagebed:latest
```

#### æ‹‰å–æœ€æ–°Betaç‰ˆæœ¬
```bash
docker pull lansepyy/tg-telegram-imagebed:beta
```

#### æ‹‰å–ç‰¹å®šBetaç‰ˆæœ¬
```bash
docker pull lansepyy/tg-telegram-imagebed:beta-5
```

#### æ‹‰å–ç‰¹å®šæ—¥æœŸç‰ˆæœ¬
```bash
docker pull lansepyy/tg-telegram-imagebed:20251218-abc1234
```

### ğŸ—ï¸ æ„å»ºç‰¹æ€§

- âœ… å¤šæ¶æ„æ”¯æŒï¼š`linux/amd64` å’Œ `linux/arm64`
- âœ… æ„å»ºç¼“å­˜ï¼šä½¿ç”¨GitHub Actionsç¼“å­˜åŠ é€Ÿæ„å»º
- âœ… è‡ªåŠ¨ç‰ˆæœ¬å·ï¼šBetaç‰ˆæœ¬è‡ªåŠ¨é€’å¢
- âœ… Gitæ ‡ç­¾åŒæ­¥ï¼šBetaå‘å¸ƒæ—¶è‡ªåŠ¨åˆ›å»ºGitæ ‡ç­¾

### ğŸ”„ ç‰ˆæœ¬ç®¡ç†ç­–ç•¥

```
mainåˆ†æ”¯æ¨é€
    â†“
è‡ªåŠ¨æ„å»º latest + æ—¥æœŸç‰ˆæœ¬
    â†“
ç”Ÿäº§ç¯å¢ƒä½¿ç”¨

æ‰‹åŠ¨è§¦å‘Beta
    â†“
è‡ªåŠ¨é€’å¢ç‰ˆæœ¬å·ï¼ˆbeta-Nï¼‰
    â†“
æµ‹è¯•ç¯å¢ƒä½¿ç”¨
    â†“
æµ‹è¯•é€šè¿‡åæ‰‹åŠ¨è§¦å‘Latest
```

### ğŸ“Š å·¥ä½œæµçŠ¶æ€æŸ¥çœ‹

è®¿é—®ï¼š`https://github.com/lansepyy/tg-telegram-imagebed/actions`

å¯ä»¥æŸ¥çœ‹ï¼š
- æ„å»ºè¿›åº¦
- æ„å»ºæ—¥å¿—
- ç”Ÿæˆçš„é•œåƒæ ‡ç­¾
- æ„å»ºå†å²è®°å½•

### âš ï¸ æ³¨æ„äº‹é¡¹

1. **é¦–æ¬¡ä½¿ç”¨**ï¼šç¡®ä¿å·²åœ¨GitHubä»“åº“è®¾ç½®ä¸­é…ç½®å¥½Docker Hubçš„Secrets
2. **Betaç‰ˆæœ¬**ï¼šåªèƒ½é€šè¿‡æ‰‹åŠ¨è§¦å‘å·¥ä½œæµåˆ›å»º
3. **Gitæ ‡ç­¾**ï¼šBetaç‰ˆæœ¬ä¼šè‡ªåŠ¨åˆ›å»ºå¯¹åº”çš„Gitæ ‡ç­¾ï¼ˆå¦‚beta-1, beta-2ï¼‰
4. **æƒé™è¦æ±‚**ï¼šworkflowéœ€è¦`contents: write`æƒé™æ¥åˆ›å»ºGitæ ‡ç­¾
5. **æ„å»ºæ—¶é—´**ï¼šå¤šæ¶æ„æ„å»ºå¯èƒ½éœ€è¦10-20åˆ†é’Ÿ

### ğŸ†˜ æ•…éšœæ’æŸ¥

**é—®é¢˜ï¼šæ¨é€å¤±è´¥ï¼ˆ401 Unauthorizedï¼‰**
- æ£€æŸ¥DOCKERHUB_TOKENæ˜¯å¦æ­£ç¡®é…ç½®
- æ£€æŸ¥Docker Hubè®¿é—®ä»¤ç‰Œæ˜¯å¦è¿‡æœŸ
- ç¡®è®¤DOCKERHUB_USERNAMEæ‹¼å†™æ­£ç¡®

**é—®é¢˜ï¼šBetaç‰ˆæœ¬å·æœªé€’å¢**
- æ£€æŸ¥Gitæ ‡ç­¾æ˜¯å¦æ­£ç¡®æ¨é€
- æ‰‹åŠ¨æŸ¥çœ‹ç°æœ‰æ ‡ç­¾ï¼š`git tag -l "beta-*"`
- å¯èƒ½éœ€è¦æ‰‹åŠ¨æ¸…ç†é”™è¯¯çš„æ ‡ç­¾

**é—®é¢˜ï¼šæ„å»ºè¶…æ—¶**
- å¤šæ¶æ„æ„å»ºéœ€è¦è¾ƒé•¿æ—¶é—´ï¼Œå±äºæ­£å¸¸ç°è±¡
- å¯ä»¥è€ƒè™‘åªæ„å»ºå•æ¶æ„åŠ å¿«é€Ÿåº¦

### ğŸ“ è‡ªå®šä¹‰é…ç½®

å¦‚éœ€ä¿®æ”¹é…ç½®ï¼Œç¼–è¾‘ `.github/workflows/docker-publish.yml` æ–‡ä»¶ï¼š

- ä¿®æ”¹æ„å»ºå¹³å°ï¼š`platforms: linux/amd64,linux/arm64`
- ä¿®æ”¹æ ‡ç­¾è§„åˆ™ï¼š`tags:` éƒ¨åˆ†
- ä¿®æ”¹è§¦å‘æ¡ä»¶ï¼š`on:` éƒ¨åˆ†
